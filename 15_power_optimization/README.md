# Оптимизация затрат при производстве стали

## Легенда

Чтобы оптимизировать производственные расходы, металлургический комбинат решил уменьшить потребление электроэнергии на этапе обработки стали. 
Нам необходимо построить модель, которая предскажет температуру стали.

Для выполнения задачи оптимизации производственных расходов, путем уменьшения потребления, была сформирована задача: 
Разработать предсказательную модель температуры расплавленного состояния сплава.

Для поэтапного выполнения поставленной задачи был составлен план работ составленный из трех тематических блоков.

**1. Ключевые вопросы**

**1.1 План работы**

*Первая часть работы*

В первой части работы проведен исследовательский анализ данных, выявлены взаимосвязи и закономерности между предоставленными таблицами. Изучение данных проводилось с помощью инструментов визуализации, а также при опросе заказчика. Также был выявлен целевой признак. Все пункты данной части выполнены в соответсвии с планом.

*Вторая часть работы*

Во второй части проведена работа по подготовке признаков для модели машинного обучения. Для этого на основании предшествующего анализа был составлен отдельный датафрейм отражающий различные показатели связанные с каждой партией стали. Также были сгенерированы дополнительные признаки позволившие повыситьточность модели. 
Признаки содержат следующую информацию: начальная температура сплава, информация о массе и количестве источников дополнительных присадок и материалов, время работы и нагрева сплава, полная и средняя мощность при изготовлении конкретной партии.
Перед применением, признаки были проверены а мультиколлинеарность.

*Третья часть работы*

Третья часть работы представляет собой непосредственный подбор лучшей модели. Для этого итоговая таблица была разделена на на обучающую и тестовую выборку в соотношении 75 и 25 % соответсвенно. Для более эффективного поиска лучшей модели и параметров бы сформирован пайплайн и словарь обучаемых моделей со списком перебираемых параметров. Оценка лучшей модели производилась с помощью кросс-валидации, итоговая метрика заявленная заказчиком mean absolute error. Также после выбора лучшей модели составлен список наиболее важных для модели признаков.

Все пункты плана выполнены в полном объёме.

**1.2 Трудности при выполнении работы**

При подготовке модели наибольшую трудность представляет изучение и подготовка данных. Для этого необходимо тщательно исследовать предоставленные материалы и вырабатывать методику по выявлению и объединению потенциально полезной для модели информации в один датафрейм. Также важно сформировать дополнительные признаки не допустив утечку данных. Дополнительную сложность вносит недостаточная осведомленнность о производственых процессах организации с которыми необходимо предварительно ознакомиться.

**1.3 Ключевые шаги**

Ключевые шаги обозначены в плане работы. Касательно промежуточных операций наиболее важными шагами можно считать формирования большого датасета содержащего все необходиме для работы модели признаки. Вторым по значимости шагом является отсеивание этих признаков на основе проверки на мультиколлинеарность признаков.

**1.4 Итоговая модель**

Наилучшим образом себя показала модель CatBoostRegressor с итогым значением 6.17 МАЕ на обучающей выборке. В результате проверки на тестововой выборке удалось определить температуру итогового сырья с точностью 5.89 МАЕ


**2. Список признаков**

target - целевой признак, выделен из таблицы data_temp. Последняя измеренная температура в партии.

temp_start - первый по важности признак, выгружен из таблицы data_temp. Начальная температура партии.

full_time_sec - продолжительность работы с ковшом, подсчитан на основе информации о продолжительности каждой итерации data_temp.

bulk_resource, bulk_count - данныые о подаче сыпучих материалов были агрегированы из таблицы data_bulk по суммарной массе и количеству источников материала.

wire_resource, wire_count - аналогично предыдущему пункту, источник данных data_wire.

full_power_start, full_power_finish - сгенерирован из данных об активной и реактивной мощности таблицы data_arc. Признак расчитан по формуле полной мощности обозначенной в работе.

gas - выгружен из таблицы data_gas в соответствии с номером партии.

time_warm_sec = родолжительность нагрева сплава, подсчитан на основе информации о продолжительности каждой итерации нагрева data_arc.

act_mean - средняя активная мощность на партию. Агрегирован на основании соответствующего столбца таблицы data_arc.

**3. Гиперпараметры лучшей модели**

Для модели были подобраны следующие параметры:

- n_estimators - 192,
- max_depth - 2
- random_state - 230323

**4. Рекомендации**

Для улучшения работы модели стоит добавить дополнительные данные о погодных условиях на момент изготовления партии. Необходимо изучить влияние этого фактора на итоговую температуру. Дополнительно можно расчитать энергозатраты на основе данных о мощности и длительности нагрева, а также промаркировать температуру в пределах нормы и превышающуюю её для данного сплава. Примечательно, что высокое влияние на итоговую метрику показали временные признаки месяц/неделя/день недели, возможно имеются некоторые закономерности связанные с логистикой, количественным и качественным составом рабочей смены.





